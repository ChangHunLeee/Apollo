<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xmlns:websocket="http://www.springframework.org/schema/websocket"
       xsi:schemaLocation="http://www.springframework.org/schema/beans 
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/context 
                           http://www.springframework.org/schema/context/spring-context.xsd
                           http://www.springframework.org/schema/mvc
                           http://www.springframework.org/schema/mvc/spring-mvc.xsd
                           http://www.springframework.org/schema/websocket
    					   http://www.springframework.org/schema/websocket/spring-websocket.xsd">




<!-- @Autowired, @Required, @Resource, @Configuration 과 같은 어노테이션을 인식하기 위한 코드 -->
<!-- context:annotation-config 태그는 어노테이션과 관련해서 다음의 BeanPostProcessor를 함께 등록 한다.

      @Required(RequiedAnnotationBeanPostProcessor)
      @Autowired(AutowiredAnnotationBeanPostProcessor)
      @Resource, @PostConstruct, @PreDestory(CommonAnnotationBeanPostProcessor)
      @Configuration(ConfigurationClassPostProcessor)
      그 외 Repository, Service, Controller 포함 -->
<context:annotation-config />
<!-- base-package 범위 내에서 어노테이션이 적용된 클래스를 bean으로 등록 -->

<!-- 비동기 -->
<bean class="org.springframework.web.servlet.view.json.MappingJackson2JsonView" />
<context:component-scan base-package="com.apollo.*" />
	<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<property name="prefix" value="/WEB-INF/views/" />
		<property name="suffix" value=".jsp"/>
	</bean>
	
	<!-- Velocity 설정 -->
	<bean id="velocityConfig" class="org.springframework.web.servlet.view.velocity.VelocityConfigurer">
		<property name="resourceLoaderPath" value="WEB-INF/views/vm/"/>
		<property name="velocityProperties">
			<value>
				input.encoding=UTF-8
				output.encoding=UTF-8
			</value>
		</property>
	</bean>

	<bean id="velocityEngine" class="org.springframework.ui.velocity.VelocityEngineFactoryBean">
		<property name="resourceLoaderPath" value="/WEB-INF/views/vm/" />
	</bean>
	
	<bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
          <property name="maxUploadSize" value="10485760"></property>
     </bean>

	
	<mvc:interceptors>
		<mvc:interceptor>
			<mvc:mapping path="/**" /> <!-- 매핑경로 지정 -->
		 	<mvc:exclude-mapping path="/index.htm"/><!-- interceptor적용을 제외시킬 URL -->
		 	<mvc:exclude-mapping path="/keycheck.htm"/>
		 	<mvc:exclude-mapping path="/login.htm"/>
		 	<mvc:exclude-mapping path="/join.htm"/>
		 	<mvc:exclude-mapping path="/joinform.htm"/>
		 	<mvc:exclude-mapping path="/emailcheck.htm"/>
		 	<mvc:exclude-mapping path="/apollokey.htm"/>
		 	<mvc:exclude-mapping path="/findpwd.htm"/>
		 	<mvc:exclude-mapping path="/google.htm"/>
		 	<mvc:exclude-mapping path="/googlelogin.htm"/>
			<bean id ="exInterceptor" class ="inter.ExInterceptor"/>
		</mvc:interceptor>
		<mvc:interceptor>
			<mvc:mapping path="/pageReloadEvent.htm" /> 
			<bean id ="ReloadInterceptor" class ="inter.ReloadInterceptor"/>
		</mvc:interceptor>
	</mvc:interceptors>
	
	<mvc:annotation-driven/>
	 	<!--Socket -->
 	
	<bean id="main" class="socket.ChatWebSocketHandler" />
	<websocket:handlers>
		<websocket:mapping handler="main" path="/main.htm" />
		<websocket:handshake-interceptors>
			 <bean class="socket.HandShakeInterceptor"/>
			 <!-- <bean class="org.springframework.web.socket.server.support.HttpSessionHandshakeInterceptor"></bean> -->
		</websocket:handshake-interceptors>
	</websocket:handlers> 
</beans>
